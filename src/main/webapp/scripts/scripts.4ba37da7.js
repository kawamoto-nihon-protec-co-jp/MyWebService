"use strict";var cnt=0;angular.module("appApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngGrid","ui.bootstrap","googlechart","google-maps".ns()]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/grid",{templateUrl:"views/grid.html",controller:"GridCtrl"}).when("/charts",{templateUrl:"views/charts.html",controller:"ChartsCtrl"}).when("/map",{templateUrl:"views/map.html",controller:"MapCtrl"}).otherwise({redirectTo:"/"})}]).controller("TabCtrl",["$scope",function(a){a.isHomeActive=!0,a.tabHomeClick=function(){a.isHomeActive=!0,a.isGridActive=!1,a.isChartsActive=!1},a.tabGridClick=function(){a.isHomeActive=!1,a.isGridActive=!0,a.isChartsActive=!1},a.tabChartClick=function(){a.isHomeActive=!1,a.isGridActive=!1,a.isChartsActive=!0}}]),angular.module("appApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("appApp").controller("GridCtrl",["$scope","$http","$rootScope",function(a,b,c){var d="http://54.64.73.55:8000/webservice/api/resource/getGridData";a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.filterOptions={filterText:"",useExternalFilter:!0},a.totalServerItems=0,a.pagingOptions={pageSizes:[5,10,20,30],pageSize:10,currentPage:1},a.setPagingData=function(b,c,d){var e=b.slice((c-1)*d,c*d);a.myData=e,a.totalServerItems=b.length,a.$$phase||a.$apply()},a.getPagedDataAsync=function(c,e,f){setTimeout(function(){var g;if(f){var h=f.toLowerCase();b.get(d).success(function(b){g=b.filter(function(a){return-1!=JSON.stringify(a).toLowerCase().indexOf(h)}),a.setPagingData(g,e,c)}).error(function(){})}else b.get(d).success(function(b){b.data.slice((e-1)*c,e*c);a.setPagingData(b.data,e,c)}).error(function(){})},100)},a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage),a.$watch("pagingOptions",function(b,c){b===c||b.currentPage===c.currentPage&&b.pageSize===c.pageSize||a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage,a.filterOptions.filterText)},!0),a.$watch("filterOptions",function(b,c){b!==c&&a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage,a.filterOptions.filterText)},!0),a.mySelections=[],a.hrefMap='<a href="#/map" ng-click="doChart(row)">地図</a>',a.gridOptions={data:"myData",enablePaging:!0,showFooter:!0,showFilter:!0,enableColumnResize:!0,enableRowSelection:!0,multiSelect:!1,totalServerItems:"totalServerItems",pagingOptions:a.pagingOptions,selectedItems:a.mySelections,columnDefs:[{displayName:"#",width:30,cellTemplate:'<div align="right">{{row.rowIndex+startCount+1}}</div>'},{field:"userId",displayName:"ユーザ",width:90},{field:"heartRate",displayName:"心拍数",width:60},{field:"assayDate",displayName:"測定日",width:200},{field:"gpsLatitude",displayName:"測定場所",width:"*",cellTemplate:a.hrefMap}]},a.doSearch=function(){a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage)},a.doChart=function(a){c.gpsLatitude=a.entity.gpsLatitude,c.gpsLongitube=a.entity.gpsLongitude}}]),angular.module("appApp").controller("ChartsCtrl",["$scope","$http","$resource","$rootScope",function(a,b){function c(){console.log("createChart");var b={};return b.type="LineChart",b.data=a.chartData,b.options={title:"【心拍数推移】",dataOpacity:.5,height:400,isStacked:!0,animation:{duration:3e3,easing:"linear"},hAxis:{slantedText:!0,viewWindowMode:"pretty",textPosition:"out",title:"測定日"},vAxis:{textPosition:"out",title:"心拍数",ticks:[110,105,100,95,90,85,80,75,70,65,60,55,50]},seriesType:"line"},b}a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.chartData=[];var d="http://54.64.73.55:8000/webservice/api/resource/getChartData";b.get(d).success(function(b){console.log("getHealthData"),a.chartData=b,a.heartRateChart=c()}).error(function(){})}]),angular.module("appApp").controller("MapCtrl",["$scope","$http","$rootScope",function(a,b,c){a.map={center:{latitude:c.gpsLatitude,longitude:c.gpsLongitube},zoom:14},a.options={scrollwheel:!1},a.coordsUpdates=0,a.dynamicMoveCtr=0,a.marker={id:0,coords:{latitude:c.gpsLatitude,longitude:c.gpsLongitube},options:{draggable:!0},events:{dragend:function(b){$log.log("marker dragend");var c=b.getPosition().lat(),d=b.getPosition().lng();$log.log(c),$log.log(d),a.marker.options={draggable:!0,labelContent:"lat: "+a.marker.coords.latitude+" lon: "+a.marker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"}}}},a.$watchCollection("marker.coords",function(b,c){_.isEqual(b,c)||a.coordsUpdates++})}]);